"use strict";(self["webpackChunkbutton_with_sound"]=self["webpackChunkbutton_with_sound"]||[]).push([[217],{3208:function(e,t,r){r.r(t),r.d(t,{default:function(){return B}});var o=r(3396),n=r(7139),s=r(9242);const a=e=>((0,o.dD)("data-v-62e62cea"),e=e(),(0,o.Cn)(),e),i=["href"],c={id:"mole"},l=a((()=>(0,o._)("h1",null,[(0,o.Uk)("蘑菇? 蘑菇!"),(0,o._)("br"),(0,o._)("span",{class:"score"},"0")],-1))),d={class:"d-grid gap-2 d-md-block mx-auto"},u={class:"game"},h=a((()=>(0,o._)("div",{class:"mole"},null,-1))),m=[h],p={key:0,class:"overlay"},f={class:"LeaderBoard"},w=a((()=>(0,o._)("br",null,null,-1))),g={key:0};function k(e,t,r,a,h,k){const b=(0,o.up)("dif");return(0,o.wg)(),(0,o.iD)(o.HY,null,[(0,o._)("a",{class:"btn btn-primary home",href:"/#/quiz?username="+this.nickname,role:"button"},"⬅回問答",8,i),(0,o._)("div",c,[(0,o._)("div",null,[l,(0,o._)("div",d,[(0,o._)("button",{onClick:t[0]||(t[0]=(...e)=>k.startGame&&k.startGame(...e)),class:"btn btn-primary mt-3 mx-2"},"開始蘑菇"),(0,o._)("button",{onClick:t[1]||(t[1]=(...e)=>k.getLeaderBoard&&k.getLeaderBoard(...e)),class:"btn btn-primary mt-3"},"排行榜")])]),(0,o.wy)((0,o._)("div",u,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(this.holeCount,(e=>((0,o.wg)(),(0,o.iD)("div",{key:e,class:(0,n.C_)("hole hole"+e)},m,2)))),128))],512),[[s.F8,!h.turnOff]])]),h.leaderBoard.length>0?((0,o.wg)(),(0,o.iD)("div",p,[(0,o._)("div",f,[(0,o._)("button",{onClick:t[2]||(t[2]=(...e)=>k.closeLeaderBoard&&k.closeLeaderBoard(...e)),class:"btn btn-danger close-btn"},"×"),((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(h.leaderBoard,((e,t)=>((0,o.wg)(),(0,o.iD)("div",{key:t,class:"player-score"},[(0,o._)("h3",null,"第"+(0,n.zw)(t+1)+"名: "+(0,n.zw)(e.username)+": "+(0,n.zw)(e.score)+"分",1)])))),128)),(0,o.Uk)(" ...... "),w,h.currentScore>0?((0,o.wg)(),(0,o.iD)("h3",g,"你是 第"+(0,n.zw)(h.currentRank)+"名: "+(0,n.zw)(h.nickname)+": "+(0,n.zw)(h.currentScore)+"分",1)):(0,o.kq)("",!0)])])):(0,o.kq)("",!0),(0,o.Wm)(b,{class:"credit"},{default:(0,o.w5)((()=>[(0,o.Uk)("credit: 一尾懶鯉魚")])),_:1})],64)}var b=r.p+"media/mushroom.83898fd7.mp3",_=r.p+"media/nope.eedfcb0b.mp3",S={el:"#mole",data(){return{nickname:"",holeCount:9,currentScore:0,currentRank:0,isStart:!1,turnOff:!1,lastHole:null,moles:[],bgmAudio:new Audio(b),leaderBoard:{}}},mounted(){const e=(e,t)=>{t||(t=window.location.href),e=e.replace(/[[\]]/g,"\\$&");const r=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)"),o=r.exec(t);return o?o[2]?decodeURIComponent(o[2].replace(/\+/g," ")):"":null};if(e("username")&&(this.nickname=e("username")),window.innerWidth<=768){const e=document.querySelector(".game");e.style="width: "+window.outerWidth+"px; height: "+window.outerHeightHeight+"px;"}this.moles=document.querySelectorAll(".mole"),this.moles.forEach((e=>{e.addEventListener("click",this.score)}))},beforeRouteLeave(e,t,r){this.bgmAudio.pause(),r()},methods:{startGame(){this.isStart||(this.isStart=!0,this.currentScore=0,this.currentRank=0,this.closeLeaderBoard(),document.querySelector(".score").textContent=this.currentScore,this.popUp(),this.bgmAudio.play(),setTimeout((()=>{this.turnOff=!0,this.isStart=!1,this.uploadScore()}),37e3))},popUp(){const e=this.randomTime(500,900),t=this.randomHoles();t&&(t.classList.add("up"),setTimeout((()=>{t.classList.remove("up"),!1===this.turnOff?this.popUp():this.turnOff=!1}),e))},randomTime(e,t){return Math.floor(Math.random()*(t-e)+e)},randomHoles(){const e=document.querySelectorAll(".hole"),t=Math.floor(Math.random()*this.holeCount),r=e[t];return r===this.lastHole?this.randomHoles():(this.lastHole=r,r)},score(e){e.isTrusted&&(this.playSoundEffect(),this.currentScore++,document.querySelector(".score").textContent=this.currentScore,e.target.parentNode.classList.remove("up"))},playSoundEffect(){const e=new Audio(_);let t=!1,r=!1;r&&(e.pause(),e.currentTime=0),t&&(t=!1,r=!1,e.onerror=function(){t=!0});const o=e.play();void 0!==o&&o.then((e=>{r=!0})).catch((e=>{t=!0}))},uploadScore(){0!==this.currentScore&&""!==this.nickname&&(fetch(`https://gordon-the-owl.tw/api/mole?score=${this.currentScore}&username=${this.nickname}`,{method:"POST",headers:{"Content-Type":"application/json"}}).then((e=>e.json())).then((e=>{this.currentRank=e.rank,console.log("this.currentRank "+this.currentRank)})).catch((e=>{console.error("uploadScore Error:",e)})),setTimeout((()=>{this.getLeaderBoard()}),1e3))},getLeaderBoard(){this.turnOff=!0,fetch("https://gordon-the-owl.tw/api/mole",{method:"GET"}).then((e=>e.json())).then((e=>{console.log(e.leader_board[0].username),0!==e.leader_board&&(this.leaderBoard=e.leader_board)})).catch((e=>{console.error("getLeaderBoard Error:",e)}))},closeLeaderBoard(){this.turnOff=!1,this.leaderBoard={}}}},y=r(89);const v=(0,y.Z)(S,[["render",k],["__scopeId","data-v-62e62cea"]]);var B=v}}]);
//# sourceMappingURL=217.108cdc02.js.map