"use strict";(self["webpackChunkbutton_with_sound"]=self["webpackChunkbutton_with_sound"]||[]).push([[960],{6478:function(e,t,o){o.r(t),o.d(t,{default:function(){return H}});var r=o(3396),n=o(7139),a=o(9242);const s=e=>((0,r.dD)("data-v-19d52fb0"),e=e(),(0,r.Cn)(),e),i={id:"mole"},c=s((()=>(0,r._)("h1",null,[(0,r.Uk)("蘑菇? 蘑菇!"),(0,r._)("br"),(0,r._)("span",{class:"score"},"0")],-1))),l={class:"d-grid gap-2 d-md-block mx-auto"},d={class:"game"},u=s((()=>(0,r._)("div",{class:"mole"},null,-1))),h=[u],m={key:0,class:"overlay"},p={class:"LeaderBoard"},k=s((()=>(0,r._)("br",null,null,-1))),f={key:0},w={key:0},g={key:1},b=s((()=>(0,r._)("div",null,"輸入名稱才可以上排行榜喔!",-1))),S={class:"form-group"};function _(e,t,o,s,u,_){const y=(0,r.up)("BackToQuiz"),v=(0,r.up)("dif");return(0,r.wg)(),(0,r.iD)(r.HY,null,[(0,r.Wm)(y,{nickname:this.nickname},null,8,["nickname"]),(0,r._)("div",i,[(0,r._)("div",null,[c,(0,r._)("div",l,[(0,r._)("button",{onClick:t[0]||(t[0]=(...e)=>_.startGame&&_.startGame(...e)),class:"btn btn-primary mt-3 mx-2"},"開始蘑菇"),(0,r._)("button",{onClick:t[1]||(t[1]=(...e)=>_.getLeaderBoard&&_.getLeaderBoard(...e)),class:"btn btn-primary mt-3"},"排行榜")])]),(0,r.wy)((0,r._)("div",d,[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(this.holeCount,(e=>((0,r.wg)(),(0,r.iD)("div",{key:e,class:(0,n.C_)("hole hole"+e)},h,2)))),128))],512),[[a.F8,!u.turnOff]])]),u.leaderBoard.length>0?((0,r.wg)(),(0,r.iD)("div",m,[(0,r._)("div",p,[(0,r._)("button",{onClick:t[2]||(t[2]=(...e)=>_.closeLeaderBoard&&_.closeLeaderBoard(...e)),class:"btn btn-danger close-btn"},"×"),((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(u.leaderBoard,((e,t)=>((0,r.wg)(),(0,r.iD)("div",{key:t,class:"player-score"},[(0,r._)("h3",null,"第"+(0,n.zw)(t+1)+"名: "+(0,n.zw)(e.username)+": "+(0,n.zw)(e.score)+"分",1)])))),128)),(0,r.Uk)(" ...... "),k,u.currentScore>0?((0,r.wg)(),(0,r.iD)("div",f,[u.currentRank>0?((0,r.wg)(),(0,r.iD)("h3",w,"你是 第"+(0,n.zw)(u.currentRank)+"名: "+(0,n.zw)(u.nickname)+": "+(0,n.zw)(u.currentScore)+"分",1)):((0,r.wg)(),(0,r.iD)("div",g,[b,(0,r._)("div",S,[(0,r.wy)((0,r._)("input",{type:"text",class:"col-4 mx-auto form-control","onUpdate:modelValue":t[3]||(t[3]=t=>e.nicknameInput=t),placeholder:"輸入名稱"},null,512),[[a.nr,e.nicknameInput]])]),(0,r._)("button",{class:"btn btn-primary mt-2",onClick:t[4]||(t[4]=(...e)=>_.setNicknameAndUploadScore&&_.setNicknameAndUploadScore(...e))},"確定名稱")]))])):(0,r.kq)("",!0)])])):(0,r.kq)("",!0),(0,r.Wm)(v,{class:"credit"},{default:(0,r.w5)((()=>[(0,r.Uk)("credit: 一尾懶鯉魚")])),_:1})],64)}var y=o.p+"media/mushroom.83898fd7.mp3",v=o.p+"media/nope.eedfcb0b.mp3",B=o(9587),C={el:"#mole",components:{BackToQuiz:B.Z},data(){return{nickname:"",holeCount:9,currentScore:1,currentRank:0,isStart:!1,turnOff:!1,lastHole:null,moles:[],bgmAudio:new Audio(y),leaderBoard:{}}},mounted(){const e=(e,t)=>{t||(t=window.location.href),e=e.replace(/[[\]]/g,"\\$&");const o=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)"),r=o.exec(t);return r?r[2]?decodeURIComponent(r[2].replace(/\+/g," ")):"":null};if(e("username")&&(this.nickname=e("username")),window.innerWidth<=768){const e=document.querySelector(".game");e.style="width: "+window.outerWidth+"px; height: "+window.outerHeightHeight+"px;"}this.moles=document.querySelectorAll(".mole"),this.moles.forEach((e=>{e.addEventListener("click",this.score)}))},beforeRouteLeave(e,t,o){this.bgmAudio.pause(),o()},methods:{startGame(){this.isStart||(this.isStart=!0,this.currentScore=0,this.currentRank=0,this.closeLeaderBoard(),document.querySelector(".score").textContent=this.currentScore,this.popUp(),this.bgmAudio.play(),setTimeout((()=>{this.turnOff=!0,this.isStart=!1,this.uploadScore()}),37e3))},popUp(){const e=this.randomTime(500,900),t=this.randomHoles();t&&(t.classList.add("up"),setTimeout((()=>{t.classList.remove("up"),!1===this.turnOff?this.popUp():this.turnOff=!1}),e))},randomTime(e,t){return Math.floor(Math.random()*(t-e)+e)},randomHoles(){const e=document.querySelectorAll(".hole"),t=Math.floor(Math.random()*this.holeCount),o=e[t];return o===this.lastHole?this.randomHoles():(this.lastHole=o,o)},score(e){e.isTrusted&&(this.playSoundEffect(),this.currentScore++,document.querySelector(".score").textContent=this.currentScore,e.target.parentNode.classList.remove("up"))},playSoundEffect(){const e=new Audio(v);let t=!1,o=!1;o&&(e.pause(),e.currentTime=0),t&&(t=!1,o=!1,e.onerror=function(){t=!0});const r=e.play();void 0!==r&&r.then((e=>{o=!0})).catch((e=>{t=!0}))},uploadScore(){0!==this.currentScore&&""!==this.nickname&&fetch(`https://gordon-the-owl.tw/api/mole?score=${this.currentScore}&username=${this.nickname}`,{method:"POST",headers:{"Content-Type":"application/json"}}).then((e=>e.json())).then((e=>{this.currentRank=e.rank,console.log("this.currentRank "+this.currentRank)})).catch((e=>{console.error("uploadScore Error:",e)})),setTimeout((()=>{this.getLeaderBoard()}),1e3)},getLeaderBoard(){this.isStart||(this.turnOff=!0,fetch("https://gordon-the-owl.tw/api/mole",{method:"GET"}).then((e=>e.json())).then((e=>{console.log(e),0!==e.leader_board.length?this.leaderBoard=e.leader_board:this.leaderBoard=[{username:"還沒有玩家",score:0}]})).catch((e=>{this.turnOff=!1,console.error("getLeaderBoard Error:",e)})))},closeLeaderBoard(){this.turnOff=!1,this.leaderBoard={}},setNicknameAndUploadScore(){this.nickname=this.nicknameInput.trim(),""!==this.nickname&&this.uploadScore()}}},L=o(89);const T=(0,L.Z)(C,[["render",_],["__scopeId","data-v-19d52fb0"]]);var H=T}}]);
//# sourceMappingURL=960.f199617c.js.map